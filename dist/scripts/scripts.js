"use strict";angular.module("hearthstoneApp",["ui.bootstrap","ngTouch","angular-carousel"]);var hsApp=angular.module("hearthstoneApp");hsApp.controller("MainCtrl",["$scope","$rootScope","$http","HearthstoneService","$timeout","$modal",function(a,b,c,d){a.categories=["Reward","Promotion","Expert","Basic","Curse of Naxxramas"],d.getData().then(function(b){a.allCards=d.flattenJson(b,a.categories),a.cards=d.shuffle(a.allCards),a.categories=["All","Basic","Expert","Naxxramas","Reward","Promotion"],a.rarities=["All","Free","Common","Rare","Epic","Legendary"],a.classes=["All","Neutral","Mage","Warrior","Shaman","Priest","Paladin","Druid","Hunter","Warlock","Rogue"],a.types=["All","Minion","Weapon","Spell"],a.activeFilter={"class":"All",rarity:"All",type:"All",category:"All"}}),a.activeFilter=function(){return a.activeFilter},a.changeFilter=function(){b.$broadcast("filterChanged"),a.cards=d.shuffle(d.filterCards(a.allCards,a.activeFilter))},b.$on("cardChange",function(){for(var b=0;b<a.cards.length;b++)a.cards[b].active=!1;document.getElementById("cardType").blur(),document.getElementById("cardCategory").blur(),document.getElementById("cardRarity").blur(),document.getElementById("cardClass").blur()}),b.$on("cardFlipKeyup",function(b,c){var d=a.cards[c.carouselIndex];d.active=!d.active})}]),angular.module("hearthstoneApp").factory("HearthstoneService",["$http",function(a){var b={getData:function(){var b=a.get("AllSets.json").then(function(a){return a.data});return b},flattenJson:function(a,b){for(var c=[],d=["Enchantment","Hero"],e=0;e<b.length;e++){var f=a[b[e]];f.forEach(function(a){var f=-1!==d.indexOf(a.type),g=a.collectible!==!0;f||g||(a.playerClass||(a.playerClass="Neutral"),a.category=b[e],"Curse of Naxxramas"===a.category&&(a.category="Naxxramas"),a.active=!1,c.push(a))})}return c},getRarityValue:function(a,b){var c=!1;return a.forEach(function(a){a.title===b&&(c=a.checked)}),c},filterCards:function(a,b){var c=[];return a.forEach(function(a){var d="All"===b.type||b.type===a.type,e="All"===b.class||b.class===a.playerClass,f="All"===b.category||b.category===a.category,g="All"===b.rarity||b.rarity===a.rarity;d&&e&&f&&g&&c.push(a)}),c},shuffle:function(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}};return b}]),angular.module("angular-carousel",["ngTouch"]),angular.module("angular-carousel").directive("rnCarouselAutoSlide",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){var e=Math.round(1e3*parseFloat(d.rnCarouselAutoSlide)),f=increment=!1,g=c.children().length;b.carouselExposedIndex||(b.carouselExposedIndex=0),stopAutoplay=function(){angular.isDefined(f)&&a.cancel(f),f=void 0},increment=function(){b.carouselExposedIndex=b.carouselExposedIndex<g-1?b.carouselExposedIndex+1:0},restartTimer=function(){stopAutoplay(),f=a(increment,e)},b.$watch("carouselIndex",function(){restartTimer()}),restartTimer(),d.rnCarouselPauseOnHover&&"false"!=d.rnCarouselPauseOnHover&&(c.on("mouseenter",stopAutoplay),c.on("mouseleave",restartTimer)),b.$on("$destroy",function(){stopAutoplay(),c.off("mouseenter",stopAutoplay),c.off("mouseleave",restartTimer)})}}}]),angular.module("angular-carousel").directive("rnCarouselControls",["$rootScope","$document",function(a,b){return{restrict:"A",replace:!0,scope:{items:"=",index:"="},link:function(c){c.prev=function(){c.index>0&&(c.index--,a.$broadcast("cardChange"))},c.next=function(){c.index<c.items.length-1&&(c.index++,a.$broadcast("cardChange"))},angular.element(b).bind("keyup",function(a){var b=37,d=39,e=100,f=102,g=65,h=68;a.which===b||a.which===e||a.which===g?(c.prev(),c.$apply()):(a.which===d||a.which===f||a.which===h)&&(c.next(),c.$apply())})},templateUrl:"carousel-controls.html"}}]),angular.module("angular-carousel").run(["$templateCache",function(a){a.put("carousel-controls.html",'<div class="rn-carousel-controls">\n  <span class="rn-carousel-control rn-carousel-control-prev" ng-click="prev()" ng-if="index > 0"></span>\n  <span class="rn-carousel-control rn-carousel-control-next" ng-click="next()" ng-if="index < items.length - 1"></span>\n</div>')}]),angular.module("angular-carousel").directive("rnCarouselIndicators",[function(){return{restrict:"A",replace:!0,scope:{items:"=",index:"="},templateUrl:"carousel-indicators.html"}}]),angular.module("angular-carousel").run(["$templateCache",function(a){a.put("carousel-indicators.html",'<div class="rn-carousel-indicator">\n <span ng-repeat="item in items" ng-click="$parent.index=$index" ng-class="{active: $index==$parent.index}"></span>\n</div>')}]),function(){angular.module("angular-carousel").directive("rnCarousel",["$swipe","$window","$document","$parse","$compile","$rootScope",function(a,b,c,d,e,f){var g=0,h=75,i=.05,j=3,k=b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame;return{restrict:"A",scope:!0,compile:function(l,m){var n,o,p=l.children()[0].attributes,q=!1,r=!1,s=!1;return l.addClass("rn-carousel-slides"),l.children().addClass("rn-carousel-slide"),["ng-repeat","data-ng-repeat","x-ng-repeat"].every(function(a){var b=p[a];if(angular.isDefined(b)){var c=b.value.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),d=c[3];if(n=c[1],o=c[2],n)return angular.isDefined(m.rnCarouselBuffered)&&(r=!0,b.value=n+" in "+o+"|carouselSlice:carouselBufferIndex:carouselBufferSize",d&&(b.value+=" track by "+d)),q=!0,!1}return!0}),function(l,m,n){function p(){for(var a=[],b=0;Q>b;b++)a[b]=b;l.carouselIndicatorArray=a}function t(){var a=T.children();return I=0===a.length?T[0].getBoundingClientRect().width:a[0].getBoundingClientRect().width}function u(){U.css("width","100%");var a=t();a&&U.css("width",a+"px")}function v(a){isNaN(a)&&(a=l.carouselIndex*I),P=a;var b=-Math.round(P);b+=l.carouselBufferIndex*I,T[0].style[J]=$?"translate3d("+b+"px, 0, 0)":"translate("+b+"px, 0)"}function w(){var a,b;M&&(a=Date.now()-O,b=M*Math.exp(-a/h),b>j||-j>b?(v(N-b),k(w)):z(N/I))}function x(a){return a>=Q?Q:0>=a?0:a}function y(){var a=0,b=(l.carouselBufferSize-1)/2;r&&(a=l.carouselIndex<=b?0:Q<l.carouselBufferSize?0:l.carouselIndex>Q-l.carouselBufferSize?Q-l.carouselBufferSize:l.carouselIndex-b),l.carouselBufferIndex=a}function z(a,b){return isNaN(a)&&(a=l.carouselIndex),b?(P=a*I,void F(null,null,!0)):(l.carouselIndex=x(a),y(),"$apply"!==f.$$phase&&"$digest"!==f.$$phase&&(s?l.$apply():l.$digest()),void v())}function A(){return i*I}function B(a){R=!0,F({x:a.clientX,y:a.clientY},a)}function C(a){var b=a;return 0===l.carouselIndex?b=Math.max(-A(),b):l.carouselIndex===Q-1&&(b=Math.min((Q-1)*I+A(),b)),b}function D(a){return c.bind("mouseup",B),K=!0,L=a.x,M=0,O=Date.now(),!1}function E(a){var b,c;return K&&(b=a.x,c=L-b,(c>2||-2>c)&&(R=!0,L=b,k(function(){v(C(P+c))}))),!1}function F(a,b,d){if(!b||R){c.unbind("mouseup",B),K=!1,R=!1,N=P;var e=A(),f=l.carouselIndex*I,g=f-N,h=-Math[g>=0?"ceil":"floor"](g/I),i=Math.abs(g)>e;h+l.carouselIndex>=Q&&(h=Q-1-l.carouselIndex),h+l.carouselIndex<0&&(h=-l.carouselIndex);var j=i?h:0;return N=(j+l.carouselIndex)*I,M=N-P,O=Date.now(),d&&(M=P-f),k(w),!1}}function G(){var a,b=document.createElement("p"),c={webkitTransform:"-webkit-transform",msTransform:"-ms-transform",transform:"transform"};document.body.insertBefore(b,null);for(var d in c)void 0!==b.style[d]&&(b.style[d]="translate3d(1px,1px,1px)",a=window.getComputedStyle(b).getPropertyValue(c[d]));return document.body.removeChild(b),void 0!==a&&a.length>0&&"none"!==a}function H(){u(),z()}g++;var I,J,K,L,M,N,O,P=0,Q=0,R=!1,S=!0,T=m.wrap("<div id='carousel-"+g+"' class='rn-carousel-container'></div>"),U=T.parent(),V=U.parent();if((angular.isDefined(n.rnCarouselIndicator)||angular.isDefined(n.rnCarouselControl))&&(p(),l.$watch("carouselIndex",function(a){l.indicatorIndex=a,l.carouselExposedIndex=a}),l.$watch("indicatorIndex",function(a){z(a,!0)})),angular.isDefined(n.rnCarouselPreventAnimation)&&(S=!1),l.$watch("carouselExposedIndex",function(a){z(a,!0)}),angular.isDefined(n.rnCarouselIndicator)){var W=e("<div id='carousel-"+g+"-indicator' index='indicatorIndex' items='carouselIndicatorArray' rn-carousel-indicators class='rn-carousel-indicator'></div>")(l);U.append(W)}if(angular.isDefined(n.rnCarouselControl)){var X=e("<div id='carousel-"+g+"-controls' index='indicatorIndex' items='carouselIndicatorArray' rn-carousel-controls class='rn-carousel-controls'></div>")(l);V.append(X)}if(l.carouselBufferIndex=0,l.carouselBufferSize=5,l.carouselIndex=0,n.rnCarouselIndex){var Y=function(a){Z.assign(l.$parent,a)},Z=d(n.rnCarouselIndex);angular.isFunction(Z.assign)?(l.$watch("carouselIndex",function(a){Y(a)}),l.carouselIndex=Z(l),l.$parent.$watch(Z,function(a){void 0!==a&&(a>=Q?(a=Q-1,Y(a)):0>a&&(a=0,Y(a)),z(a,S))}),s=!0):isNaN(n.rnCarouselIndex)||(l.carouselIndex=parseInt(n.rnCarouselIndex,10))}q?l.$watchCollection(o,function(a){Q=0,angular.isArray(a)?Q=a.length:angular.isObject(a)&&(Q=Object.keys(a).length),p(),I||u(),z(l.carouselIndex)}):(Q=m.children().length,p(),u()),n.$observe("rnCarouselSwipe",function(b){"false"!==b&&"off"!==b?a.bind(T,{start:D,move:E,end:F,cancel:function(a){F({},a)}}):T.unbind()}),s||z(l.carouselIndex),J="transform",["webkit","Moz","O","ms"].every(function(a){var b=a+"Transform";return"undefined"!=typeof document.body.style[b]?(J=b,!1):!0});var $=G(),_=angular.element(b);_.bind("orientationchange",H),_.bind("resize",H),l.$on("$destroy",function(){c.unbind("mouseup",B),_.unbind("orientationchange",H),_.unbind("resize",H)}),f.$on("filterChanged",function(){l.carouselIndex=0,l.carouselBufferIndex=0}),angular.element(c).bind("keyup",function(a){var b=40,c=38,d=98,e=101,g=104,h=83,i=87,j=32;(a.which===b||a.which===c||a.which===d||a.which===e||a.which===g||a.which===h||a.which===i||a.which===j)&&(f.$broadcast("cardFlipKeyup",{carouselIndex:l.carouselIndex}),l.$apply())})}}}}])}(),function(){angular.module("angular-carousel").filter("carouselSlice",function(){return function(a,b,c){return angular.isArray(a)?a.slice(b,b+c):angular.isObject(a)?a:void 0}})}();