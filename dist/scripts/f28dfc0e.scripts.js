"use strict";angular.module("hearthstoneApp",["ngCookies","ngResource","ngSanitize","ngRoute","ui.bootstrap","ngTouch","angular-carousel"]);var hsApp=angular.module("hearthstoneApp");hsApp.controller("FilterCtrl",["$scope","$modalInstance","activeFilter",function(a,b,c){a.activeFilter=c,a.ok=function(){b.close(c)},a.cancel=function(){b.dismiss("cancel")}}]),hsApp.controller("MainCtrl",["$scope","$http","HearthstoneService","$timeout","$modal",function(a,b,c,d,e){a.categories=["Reward","Promotion","Expert","Basic","Curse of Naxxramas"],c.getData().then(function(b){a.allCards=c.flattenJson(b,a.categories),a.cards=c.shuffle(a.allCards),a.activeFilter={category:{Basic:!0,Expert:!0,"Curse of Naxxramas":!0,Reward:!0,Promotion:!0},"class":{Neutral:!0,Mage:!0,Warrior:!0,Shaman:!0,Priest:!0,Paladin:!0,Druid:!0,Hunter:!0,Warlock:!0,Rogue:!0},rarity:{Free:!0,Common:!0,Rare:!0,Epic:!0,Legendary:!0},type:{Minion:!0,Spell:!0,Weapon:!0}}}),a.openFilterDialog=function(){a.prevFilter=JSON.parse(JSON.stringify(a.activeFilter));var b=e.open({templateUrl:"filterDialog.html",controller:"FilterCtrl",resolve:{activeFilter:function(){return a.activeFilter}}});b.result.then(function(){JSON.stringify(a.prevFilter)!=JSON.stringify(a.activeFilter)&&(a.cards=c.shuffle(c.filterCards(a.allCards,a.activeFilter)))},function(){})}}]),angular.module("hearthstoneApp").factory("HearthstoneService",["$http",function(a){var b={getData:function(){var b=a.get("AllSets.json").then(function(a){return a.data});return b},flattenJson:function(a,b){for(var c=[],d=["Enchantment","Hero"],e=0;e<b.length;e++){var f=a[b[e]];f.forEach(function(a){var f=-1!==d.indexOf(a.type),g=a.collectible!==!0;f||g||(a.playerClass||(a.playerClass="Neutral"),a.category=b[e],a.active=!1,c.push(a))})}return c},filterCards:function(a,b){var c=[];return a.forEach(function(a){b.type[a.type]&&(b.class[a.playerClass]||b.class.Neutral)&&b.category[a.category]&&b.rarity[a.rarity]&&c.push(a)}),console.log("number of cards after filter: ",c.length),c},shuffle:function(a){for(var b,c,d=a.length;d;b=Math.floor(Math.random()*d),c=a[--d],a[d]=a[b],a[b]=c);return a}};return b}]);